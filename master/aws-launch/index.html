<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">  
    <link rel="canonical" href="http://hortonworks.github.io/cloudbreak-documentation/aws-launch/index.html"> 
    <link rel="shortcut icon" href="../images/favicon.png">

    <title>Launch on AWS - Cloudbreak</title>

    <link href="../css/bootstrap-custom.min.css" rel="stylesheet">
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css" rel="stylesheet">
    <link rel="stylesheet" href="//cdn.jsdelivr.net/font-hack/2.018/css/hack.min.css">
    <link href='//fonts.googleapis.com/css?family=PT+Sans:400,400italic,700,700italic&subset=latin-ext,latin' rel='stylesheet' type='text/css'>
    <link href='//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,700italic,400,300,600,700&subset=latin-ext,latin' rel='stylesheet' type='text/css'>
    <link href="../css/base.css" rel="stylesheet">
    <link href="../css/cinder.css" rel="stylesheet">
    <link rel="stylesheet" href="../css/highlight.css">


    <link href="../css/extra.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

    <script src="https://ajax.googleapis.com/ajax/libs/webfont/1.5.18/webfont.js"></script>
    <script>
    WebFont.load({
        google: {
            families: ['Open Sans', 'PT Sans']
        }
    });
    </script>

    
    <script>
    (function(i, s, o, g, r, a, m) {
        i['GoogleAnalyticsObject'] = r;
        i[r] = i[r] || function() {
            (i[r].q = i[r].q || []).push(arguments)
        }, i[r].l = 1 * new Date();
        a = s.createElement(o),
        m = s.getElementsByTagName(o)[0];
        a.async = 1;
        a.src = g;
        m.parentNode.insertBefore(a, m)
    })(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');

    ga('create', 'UA-22950817-24', 'auto');
    ga('send', 'pageview');
    </script>
    
</head>

<body>

    <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            

            <!-- Main title -->
            <a class="navbar-brand" href="../index.html">Cloudbreak</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
            
                <!-- Main navigation -->
                <ul class="nav navbar-nav">
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Get Started <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../index.html">Introduction</a>
</li>

                        
                            
<li >
    <a href="../architecture/index.html">Architecture</a>
</li>

                        
                        </ul>
                    </li>
                
                
                
                    <li class="dropdown active">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">AWS <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li class="active">
    <a href="index.html">Launch on AWS</a>
</li>

                        
                            
<li >
    <a href="../aws-create/index.html">Create a Cluster</a>
</li>

                        
                            
<li >
    <a href="../aws-clusters-access/index.html">Access Cluster</a>
</li>

                        
                            
<li >
    <a href="../aws-clusters-manage/index.html">Manage and Monitor Clusters</a>
</li>

                        
                            
<li >
    <a href="../aws-data/index.html">Access Data on S3</a>
</li>

                        
                        </ul>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Azure <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../azure-launch/index.html">Launch on Azure</a>
</li>

                        
                            
<li >
    <a href="../azure-create/index.html">Create a Cluster</a>
</li>

                        
                            
<li >
    <a href="../azure-clusters-access/index.html">Access Cluster</a>
</li>

                        
                            
<li >
    <a href="../azure-clusters-manage/index.html">Manage and Monitor Clusters</a>
</li>

                        
                            
<li >
    <a href="../azure-data/index.html">Access Data on Azure</a>
</li>

                        
                        </ul>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">GCP <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../gcp-launch/index.html">Launch on GCP</a>
</li>

                        
                            
<li >
    <a href="../gcp-create/index.html">Create a Cluster</a>
</li>

                        
                            
<li >
    <a href="../gcp-clusters-access/index.html">Access Cluster</a>
</li>

                        
                            
<li >
    <a href="../gcp-clusters-manage/index.html">Manage and Monitor Clusters</a>
</li>

                        
                        </ul>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">OpenStack <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../os-launch/index.html">Launch on Open Stack</a>
</li>

                        
                            
<li >
    <a href="../os-create/index.html">Create a Cluster</a>
</li>

                        
                            
<li >
    <a href="../os-clusters-access/index.html">Access Cluster</a>
</li>

                        
                            
<li >
    <a href="../os-clusters-manage/index.html">Manage and Monitor Clusters</a>
</li>

                        
                        </ul>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Using Cloudbreak <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="">Advanced Cluster Options</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../blueprints/index.html">Blueprints</a>
</li>

        
            
<li >
    <a href="../recipes/index.html">Recipes</a>
</li>

        
            
<li >
    <a href="../tags/index.html">Resource Tagging</a>
</li>

        
            
<li >
    <a href="../images/index.html">Custom Images</a>
</li>

        
    </ul>
  </li>

                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="">Managing Cloudbreak</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../vm-launch/index.html">Install on Your Own VM</a>
</li>

        
            
<li >
    <a href="../delete/index.html">Delete Cloudbreak</a>
</li>

        
            
<li >
    <a href="../credentials/index.html">Manage Cloudbreak Credentials</a>
</li>

        
            
<li >
    <a href="../profile/index.html">Edit Cloudbreak Profile</a>
</li>

        
            
<li >
    <a href="../cb-db/index.html">Manage Cloudbreak Database</a>
</li>

        
    </ul>
  </li>

                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="">Security</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../security/index.html">Security Overview</a>
</li>

        
            
<li >
    <a href="../security-cb/index.html">Configure Basic Security</a>
</li>

        
            
<li >
    <a href="../security-kerberos/index.html">Configure Kerberos</a>
</li>

        
    </ul>
  </li>

                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="">CLI</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../cli-install/index.html">Install the CLI</a>
</li>

        
            
<li >
    <a href="../cli-reference/index.html">CLI Reference</a>
</li>

        
    </ul>
  </li>

                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="">Troubleshooting</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../trouble-cb/index.html">General Troubleshooting</a>
</li>

        
            
<li >
    <a href="../trouble-aws/index.html">Troubleshooting AWS</a>
</li>

        
            
<li >
    <a href="../trouble-azure/index.html">Troubleshooting Azure</a>
</li>

        
            
<li >
    <a href="../trouble-gcp/index.html">Troubleshooting GCP</a>
</li>

        
            
<li >
    <a href="../trouble-os/index.html">Troubleshooting OpenStack</a>
</li>

        
    </ul>
  </li>

                        
                            
<li >
    <a href="../dev/index.html">Developer Documentation</a>
</li>

                        
                        </ul>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">More <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../releasenotes/index.html">Release Notes</a>
</li>

                        
                            
<li >
    <a href="../faq/index.html">FAQs</a>
</li>

                        
                            
<li >
    <a href="../get-help/index.html">Getting Help</a>
</li>

                        
                            
<li >
    <a href="../smartsense/index.html">SmartSense</a>
</li>

                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="">Legal</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../acknowledge/index.html">Acknowledgements</a>
</li>

        
    </ul>
  </li>

                        
                        </ul>
                    </li>
                
                
                </ul>
            

            <ul class="nav navbar-nav navbar-right">
                
                    <li >
                        <a rel="next" href="../architecture/index.html">
                            <i class="fa fa-arrow-left"></i> Previous
                        </a>
                    </li>
                    <li >
                        <a rel="prev" href="../aws-create/index.html">
                            Next <i class="fa fa-arrow-right"></i>
                        </a>
                    </li>
                
                
                    <li>
                        <a href="https://github.com/hortonworks/cloudbreak-documentation">
                            
                                <i class="fa fa-github"></i>
                            
                            GitHub
                        </a>
                    </li>
                
            </ul>
        </div>
    </div>
</div>

    <div class="container">
        
        <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
    
        <li class="first-level active"><a href="#launch-cloudbreak-on-aws">Launch Cloudbreak on AWS</a></li>
        
            <li class="second-level"><a href="#meet-the-prerequisites">Meet the Prerequisites</a></li>
            
                <li class="third-level"><a href="#aws-account">AWS Account</a></li>
            
                <li class="third-level"><a href="#aws-region">AWS Region</a></li>
            
                <li class="third-level"><a href="#ssh-key-pair">SSH Key Pair</a></li>
            
                <li class="third-level"><a href="#authentication">Authentication</a></li>
            
        
            <li class="second-level"><a href="#launch-the-vm">Launch the VM</a></li>
            
        
            <li class="second-level"><a href="#ssh-to-the-vm">SSH to the VM</a></li>
            
        
            <li class="second-level"><a href="#launch-cloudbreak-deployer">Launch Cloudbreak Deployer</a></li>
            
        
            <li class="second-level"><a href="#access-cloudbreak-ui">Access Cloudbreak UI</a></li>
            
        
            <li class="second-level"><a href="#create-cloudbreak-credential">Create Cloudbreak Credential</a></li>
            
                <li class="third-level"><a href="#create-key-based-credential">Create Key-Based Credential</a></li>
            
                <li class="third-level"><a href="#create-role-based-credential">Create Role-Based Credential</a></li>
            
        
    
    </ul>
</div></div>
        <div class="col-md-9" role="main">

<h2 id="launch-cloudbreak-on-aws">Launch Cloudbreak on AWS</h2>
<p>Before launching Cloudbreak on AWS, review and meet the prerequisites. Next, launch a VM using a Cloudbreak Amazon Machine Image, access the VM, and then start Cloudbreak. Once Cloudbreak is running, log in to the Cloudbreak UI and create a Cloudbreak credential. </p>
<h3 id="meet-the-prerequisites">Meet the Prerequisites</h3>
<p>Before launching Cloudbreak on AWS, you must meet the following prerequisites.</p>
<h4 id="aws-account">AWS Account</h4>
<p>In order to launch Cloudbreak on Azure, you must log in to your AWS account. If you don't have an account, you can create one at <a href="https://aws.amazon.com/">https://aws.amazon.com/</a>.</p>
<h4 id="aws-region">AWS Region</h4>
<p>Decide in which AWS region you would like to launch Cloudbreak. The following AWS regions are supported: </p>
<table>
<thead>
<tr>
<th>Region Name</th>
<th>Region</th>
</tr>
</thead>
<tbody>
<tr>
<td>EU (Ireland)</td>
<td>eu-west-1</td>
</tr>
<tr>
<td>EU (Frankfurt)</td>
<td>eu-central-1</td>
</tr>
<tr>
<td>US East (N. Virginia)</td>
<td>us-east-1</td>
</tr>
<tr>
<td>US West (N. California)</td>
<td>us-west-1</td>
</tr>
<tr>
<td>US West (Oregon)</td>
<td>us-west-2</td>
</tr>
<tr>
<td>South America (São Paulo)</td>
<td>sa-east-1</td>
</tr>
<tr>
<td>Asia Pacific (Tokyo)</td>
<td>ap-northeast-1</td>
</tr>
<tr>
<td>Asia Pacific (Singapore)</td>
<td>ap-southeast-1</td>
</tr>
<tr>
<td>Asia Pacific (Sydney)</td>
<td>ap-southeast-2</td>
</tr>
</tbody>
</table>
<p>Clusters created via Cloudbreak can be in the same or different region as Cloudbreak; when you launch a cluster, you select the region in which to launch it.</p>
<p><strong>Related Links</strong><br />
<a href="http://docs.aws.amazon.com/general/latest/gr/rande.html">AWS Regions and Endpoints</a> (External)   </p>
<h4 id="ssh-key-pair">SSH Key Pair</h4>
<p>Import an existing key pair or generate a new key pair in the AWS region which you are planning to use for launching Cloudbreak and clusters. You can do this using the following steps.</p>
<p><strong>Steps</strong> </p>
<ol>
<li>Navigate to the Amazon EC2 console at https://console.aws.amazon.com/ec2/.  </li>
<li>Check the region listed in the top right corner to make sure that you are in the correct region.  </li>
<li>In the left pane, find <strong>NETWORK AND SECURITY</strong> and click <strong>Key Pairs</strong>.   </li>
<li>Do one of the following:<ul>
<li>Click <strong>Create Key Pair</strong> to create a new key pair. Your private key file will be automatically downloaded onto your computer. Make sure to save it in a secure location. You will need it to SSH to the cluster nodes. You may want to change access settings for the file using <code>chmod 400 my-key-pair.pem</code>.  </li>
<li>Click <strong>Import Key Pair</strong> to upload an existing public key and then select it and click <strong>Import</strong>. Make sure that you have access to its corresponding private key.    </li>
</ul>
</li>
</ol>
<p>You need this SSH key pair to SSH to the Cloudbreak instance and start Cloudbreak. </p>
<p><strong>Related Links</strong><br />
<a href="http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-key-pairs.html#having-ec2-create-your-key-pair">Creating a Key Pair Using Amazon EC2</a> (External)  </p>
<h4 id="authentication">Authentication</h4>
<p>Before you can start using Cloudbreak for provisioning clusters, you must select a way for Cloudbreak to authenticate with your AWS account and create resources on your behalf. There are two ways to do this: </p>
<ul>
<li>
<p><strong>Key-based</strong>: This is a simpler option which does not require additional configuration at this point. It requires that you provide your AWS access key and secret key pair in the Cloudbreak web UI later. All you need to do now is check your AWS account and ensure that you can access this key pair.</p>
</li>
<li>
<p><strong>Role-based</strong>: This requires that you or your AWS admin create an IAM role to allow Cloudbreak to assume AWS roles (the "AssumeRole" policy).</p>
</li>
</ul>
<h5 id="option-1-key-based-authentication"><strong>Option 1: Key-based Authentication</strong></h5>
<p>If you are using key-based authentication for Cloudbreak on AWS, you must be able to provide your AWS access key and secret key pair. Cloudbreak will use these keys to launch the resources. You must provide the access and secret keys later in the Cloudbreak web UI later when creating a credential. </p>
<p>If you choose this option, all you need to do at this point is check your AWS account and make sure that you can access this key pair. You can generate new access and secret keys from the <strong>IAM Console</strong> &gt; <strong>Users</strong>. Next, select a user and click on the <strong>Security credentials</strong> tab:</p>
<p><a href="../images/aws-iam_security_creds.png" target="_blank" title="click to enlarge"><img src="../images/aws-iam_security_creds.png" width="650" title="IAM Console"></a> </p>
<p>If you choose this option, you can proceed to <a href="#launch-the-vm">Launch the VM</a>.</p>
<h5 id="option-2-role-based-authentication"><strong>Option 2: Role-based Authentication</strong></h5>
<p>If you are using role-based authentication for Cloudbreak on AWS, you must create two IAM roles: one to grant Cloudbreak access to allow Cloudbreak to assume AWS roles (using the "AssumeRole" policy) and the second one to provide Cloudbreak with the capabilities required for cluster creation (using the "cb-policy" policy).</p>
<p>The following table provides contextual information about the two roles required: </p>
<table>
<thead>
<tr>
<th>Role</th>
<th>Purpose</th>
<th>Overview of Steps</th>
<th>Configuration</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>CloudbreakRole</strong></td>
<td>Allows Cloudbreak to assume other IAM roles - specifically the CredentialRole.</td>
<td>Create a role called "CloudbreakRole" and attach the "AssumeRole" policy. The "AssumeRole" policy definition and steps for creating the CloudbreakRole are provided below.</td>
<td><p>When launching your Cloudbreak VM, during <strong>Step 3: Configure Instance Details</strong> &gt; <strong>IAM</strong>, you will attach the "CloudbreakRole" IAM role to the VM.</p></td>
</tr>
<tr>
<td><strong>CredentialRole</strong></td>
<td>Allows Cloudbreak to create AWS resources required for clusters.</td>
<td><p>Create a new IAM role called "CredentialRole" and attach the "cb-policy" policy to it. The "cb-policy" policy definition and steps for creating the CredentialRole are provided below.</p><p> When creating this role using the AWS Console, make sure that that it is a role for cross-account access and that the trust-relation is set up as follows: 'Account ID' is your own 12-digit AWS account ID and 'External ID' is “provision-ambari”. See steps below.</p></td>
<td>Once you log in to the Cloudbreak UI and are ready to create clusters, you will use this role to create the Cloudbreak credential.</td>
</tr>
</tbody>
</table>
<blockquote>
<p>The following alternative steps are available for the <strong>CloudbreakRole</strong>:</p>
<p>Alternatively, you can generate the "CredentialRole" role later once your Cloudbreak VM is running and once you have <a href="http://docs.aws.amazon.com/cli/latest/userguide/cli-chap-getting-started.html">configured AWS CLI</a> on your VM, by running the <code>cbd aws generate-role</code> command. This command creates a role with the name "cbreak-deployer" (equivalent to the "CredentialRole"). To customize the name of the role, add <code>export AWS_ROLE_NAME=my-cloudbreak-role-name</code> (where "my-cloudbreak-role-name" is your custom role name) as a new line to your Profile.</p>
<p>Alternatively, instead of attaching the "CloudbreakRole" role during the VM launch, you can assign the "CloudbreakRole" to an IAM user and then add the access and security key of that user to your 'Profile'.</p>
</blockquote>
<p>You can create these roles in the <strong>IAM console</strong>, on the <strong>Roles</strong> page via the <strong>Create Role</strong> option. Detailed steps are provided below. </p>
<p><strong>Create CloudbreakRole</strong></p>
<p>Use these steps to create CloudbreakRole. </p>
<p>Use the following "AssumeRole" policy definition: </p>
<pre>{
  "Version": "2012-10-17",
  "Statement": {
    "Sid": "Stmt1400068149000",
    "Effect": "Allow",
    "Action": ["sts:AssumeRole"],
    "Resource": "*"
  }
}
</pre>

<p><strong>Steps</strong></p>
<ol>
<li>
<p>Navigate to the <strong>IAM console</strong> &gt; <strong>Roles</strong> and click <strong>Create Role</strong>.</p>
<p><a href="../images/aws_role-00.png" target="_blank" title="click to enlarge"><img src="../images/aws_role-00.png" width="650" title="IAM Console"></a> </p>
</li>
<li>
<p>In the "Create Role" wizard, select <strong>AWS service</strong> role type and then select any service. </p>
<p><a href="../images/aws_role-10.png" target="_blank" title="click to enlarge"><img src="../images/aws_role-10.png" width="650" title="IAM Console"></a> </p>
</li>
<li>
<p>When done, click <strong>Next: Permissions</strong> to navigate to the next page in the wizard.</p>
</li>
<li>
<p>Click <strong>Create policy</strong>.</p>
<p><a href="../images/aws_role-11.png" target="_blank" title="click to enlarge"><img src="../images/aws_role-11.png" width="650" title="IAM Console"></a></p>
</li>
<li>
<p>Click <strong>Select</strong> next to "Create Your Own Policy".</p>
<p><a href="../images/aws_role-12.png" target="_blank" title="click to enlarge"><img src="../images/aws_role-12.png" width="650" title="IAM Console"></a>  </p>
</li>
<li>
<p>In the <strong>Policy Name</strong> field, enter "AssumeRole" and in the <strong>Policy Document</strong> paste the policy definition provided above. You can also download and copy it from <a href="https://docs.hortonworks.com/HDPDocuments/Cloudbreak/Cb-doc-resources/AssumeRole.json">here</a>.</p>
<p><a href="../images/aws_role-13.png" target="_blank" title="click to enlarge"><img src="../images/aws_role-13.png" width="650" title="IAM Console"></a>  </p>
</li>
<li>
<p>When done, click <strong>Create Policy</strong>.</p>
</li>
<li>
<p>Click <strong>Refresh</strong>. Next, find the "AsumeRole" policy that you just created and select it by checking the box.</p>
<p><a href="../images/aws_role-14.png" target="_blank" title="click to enlarge"><img src="../images/aws_role-14.png" width="650" title="IAM Console"></a> </p>
</li>
<li>
<p>When done, click <strong>Next: Review</strong>.</p>
</li>
<li>
<p>In the <strong>Roles name</strong> field, enter role name, for example "CloudbreakRole". </p>
<p><a href="../images/aws_role-15.png" target="_blank" title="click to enlarge"><img src="../images/aws_role-15.png" width="650" title="IAM Console"></a> </p>
</li>
<li>
<p>When done, click <strong>Create role</strong> to finish the role creation process.</p>
</li>
</ol>
<p><strong>Create CredentialRole</strong></p>
<p>Use these steps to create CredentialRole.</p>
<p>Use the following "cb-policy" policy definition: </p>
<pre>{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Effect": "Allow",
      "Action": [ "cloudformation:*" ],
      "Resource": [ "*" ]
    },
    {
      "Effect": "Allow",
      "Action": [ "ec2:*" ],
      "Resource": [ "*" ]
    },
    {
      "Effect": "Allow",
      "Action": [ "iam:PassRole" ],
      "Resource": [ "*" ]
    },
    {
      "Effect": "Allow",
      "Action": [ "autoscaling:*" ],
      "Resource": [ "*" ]
    }
  ]
}</pre>

<p><strong>Steps</strong></p>
<ol>
<li>
<p>Navigate to the <strong>IAM console</strong> &gt; <strong>Roles</strong> and click <strong>Create Role</strong>.</p>
<p><a href="../images/aws_role0.png" target="_blank" title="click to enlarge"><img src="../images/aws_role0.png" width="650" title="IAM Console"></a> </p>
</li>
<li>
<p>In the "Create Role" wizard, select <strong>Another AWS account</strong> role type. Next, provide the following:</p>
<ul>
<li>In the <strong>Account ID</strong> field, enter your AWS account ID.</li>
<li>Under <strong>Options</strong>, check <strong>Require external ID</strong>.</li>
<li>In the <strong>External ID</strong>, enter "provision-ambari".</li>
</ul>
<p><a href="../images/aws_role1.png" target="_blank" title="click to enlarge"><img src="../images/aws_role1.png" width="650" title="IAM Console"></a> </p>
</li>
<li>
<p>When done, click <strong>Next: Permissions</strong> to navigate to the next page in the wizard.</p>
</li>
<li>
<p>Click <strong>Create policy</strong>.</p>
<p><a href="../images/aws_role2.png" target="_blank" title="click to enlarge"><img src="../images/aws_role2.png" width="650" title="IAM Console"></a></p>
</li>
<li>
<p>Click <strong>Select</strong> next to "Create Your Own Policy".</p>
<p><a href="../images/aws_role3.png" target="_blank" title="click to enlarge"><img src="../images/aws_role3.png" width="650" title="IAM Console"></a> </p>
</li>
<li>
<p>Copy the "cb-policy" policy definition (see below).   </p>
</li>
<li>
<p>In the <strong>Policy Name</strong> field, enter "cb-policy" and in the <strong>Policy Document</strong> paste the policy definition provided above. You can also download and copy it from <a href="https://docs.hortonworks.com/HDPDocuments/Cloudbreak/Cb-doc-resources/cb-policy.json">here</a>.</p>
<p><a href="../images/aws_role4.png" target="_blank" title="click to enlarge"><img src="../images/aws_role4.png" width="650" title="IAM Console"></a>  </p>
</li>
<li>
<p>When done, click <strong>Create Policy</strong>.</p>
</li>
<li>
<p>Click <strong>Refresh</strong>. Next, find the "cb-policy" that you just created and select it by checking the box.</p>
<p><a href="../images/aws_role5.png" target="_blank" title="click to enlarge"><img src="../images/aws_role5.png" width="650" title="IAM Console"></a> </p>
</li>
<li>
<p>When done, click <strong>Next: Review</strong>.</p>
</li>
<li>
<p>In the <strong>Roles name</strong> field, enter role name, for example "CredentialRole". </p>
<p><a href="../images/aws_role6.png" target="_blank" title="click to enlarge"><img src="../images/aws_role6.png" width="650" title="IAM Console"></a> </p>
</li>
<li>
<p>When done, click <strong>Create role</strong> to finish the role creation process. </p>
</li>
</ol>
<p>Once you are done, you can proceed to <a href="#launch-the-vm">Launch the VM</a>.  </p>
<p><strong>Related Links</strong><br />
<a href="http://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_use_switch-role-ec2_instance-profiles.html">Using Instance Profiles</a> (External)<br />
<a href="http://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_use_switch-role-ec2.html">Using an IAM Role to Grant Permissions to Applications</a> (External)   </p>
<h3 id="launch-the-vm">Launch the VM</h3>
<p>Now that you've met the prerequisites, you can launch the Cloudbreak deployer VM available as a Community AMI.</p>
<p><strong>Steps</strong></p>
<ol>
<li>
<p>In the AWS Management Console, navigate to the EC2 Console.  </p>
</li>
<li>
<p>In the top right corner, select the region in which you want to launch Cloudbreak.  </p>
<p><a href="../images/aws-01.png" target="_blank" title="click to enlarge"><img src="../images/aws-01.png" width="650" title="EC2 Console"></a> </p>
</li>
<li>
<p>From the left pane, select <strong>INSTANCES</strong> &gt; <strong>Instances</strong>.  </p>
</li>
<li>
<p>Click on <strong>Launch Instance</strong>.</p>
</li>
<li>
<p>In <strong>Step 1: Choose an Amazon Machine Image (AMI)</strong> page, from the left pane, select <strong>Community AMIs</strong>. </p>
<p><a href="../images/aws-02.png" target="_blank" title="click to enlarge"><img src="../images/aws-02.png" width="650" title="EC2 Console"></a> </p>
</li>
<li>
<p>In the search box, enter the image name. The following Cloudbreak deployer images are available:</p>
<table>
<thead>
<tr>
<th>Region Name</th>
<th>Region</th>
<th>Community AMI</th>
</tr>
</thead>
<tbody>
<tr>
<td>EU (Ireland)</td>
<td>eu-west-1</td>
<td>ami-9fd57fe6</td>
</tr>
<tr>
<td>EU (Frankfurt)</td>
<td>eu-central-1</td>
<td>ami-0c1e9e63</td>
</tr>
<tr>
<td>US East (N. Virginia)</td>
<td>us-east-1</td>
<td>ami-d8d85aa2</td>
</tr>
<tr>
<td>US West (N. California)</td>
<td>us-west-1</td>
<td>ami-3598a155</td>
</tr>
<tr>
<td>US West (Oregon)</td>
<td>us-west-2</td>
<td>ami-95d003ed</td>
</tr>
<tr>
<td>South America (São Paulo)</td>
<td>sa-east-1</td>
<td>ami-ef0c4983</td>
</tr>
<tr>
<td>Asia Pacific (Tokyo)</td>
<td>ap-northeast-1</td>
<td>ami-7b47f61d</td>
</tr>
<tr>
<td>Asia Pacific (Singapore)</td>
<td>ap-southeast-1</td>
<td>ami-00b1e463</td>
</tr>
<tr>
<td>Asia Pacific (Sydney)</td>
<td>ap-southeast-2</td>
<td>ami-fff9129d</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>Click <strong>Select</strong>.  </p>
<blockquote>
<p>The steps listed below only mention required parameters. You may optionally review and adjust additional parameters. </p>
</blockquote>
</li>
<li>
<p>In <strong>Step2: Choose Instance Type</strong>, choose an instance type. The minimum instance type which is suitable for Cloudbreak is <strong>m3.large</strong>. Minimum requirements are 8GB RAM, 10GB disk, 2 cores. Click <strong>Next</strong>.</p>
<p><a href="../images/aws-03.png" target="_blank" title="click to enlarge"><img src="../images/aws-03.png" width="650" title="EC2 Console"></a>   </p>
</li>
<li>
<p>(Perform this step only if you are using role-based authorization) In <strong>Step 3: Configure Instance Details</strong> &gt; <strong>IAM</strong>, select the "CloudbreakRole" IAM role which you <a href="#authorization-for-cloudbreak">created earlier</a>.</p>
</li>
<li>
<p>In <strong>Step 6: Configure Security Group</strong>, open the following ports: 22 (for access via SSH), 80 (for access via HTTP), and 443 (for access via HTTPS).  Click <strong>Review and Launch</strong>.</p>
<p><a href="../images/aws-04.png" target="_blank" title="click to enlarge"><img src="../images/aws-04.png" width="650" title="EC2 Console"></a> </p>
</li>
<li>
<p>In <strong>Step 7: Review Instance Launch</strong>, review the information carefully and then click <strong>Launch</strong>. </p>
</li>
<li>
<p>When prompted select an existing key pair or create a new one. Next, acknowledge that you have access to the private key file and click <strong>Launch Instance</strong>. </p>
<p><a href="../images/aws-05.png" target="_blank" title="click to enlarge"><img src="../images/aws-05.png" width="400" title="EC2 Console"></a>  </p>
</li>
<li>
<p>Click on the instance ID to navigate to the <strong>Instances</strong> view in your EC2 console. </p>
<p><a href="../images/aws-06.png" target="_blank" title="click to enlarge"><img src="../images/aws-06.png" width="650" title="EC2 Console"></a>  </p>
</li>
</ol>
<h3 id="ssh-to-the-vm">SSH to the VM</h3>
<p>Now that your VM is ready, access it via SSH: </p>
<ul>
<li>Use the private key from the key pair that you selected when launching the instance. </li>
<li>The SSH user is called "cloudbreak".</li>
<li>You can obtain the host IP from the EC2 console &gt; <strong>Instances</strong> view by selecting the instance, selecting the <strong>Description</strong> tab, and copying the value of the <strong>Public DNS (IPv4) </strong> or <strong>IPv4 Public IP</strong> parameter.</li>
</ul>
<p>On Mac OS X, you can SSH to the VM by running the following from the Terminal app: <code>ssh -i "your-private-key.pem" cloudnreak@instance_IP</code> where "your-private-key.pem" points to the location of your private key and "instance_IP" is the public IP address of the VM.</p>
<p>On Windows, you can use <a href="http://www.putty.org/">PuTTy</a>.</p>
<h3 id="launch-cloudbreak-deployer">Launch Cloudbreak Deployer</h3>
<p>After accessing the VM via SSH, launch Cloudbreak deployer using the following steps.  </p>
<p><strong>Steps</strong>  </p>
<ol>
<li>
<p>Navigate to the cloudbreak-deployment directory:</p>
<p><pre>cd /var/lib/cloudbreak-deployment/</pre></p>
<p>This directory contains configuration files and the supporting binaries for Cloudbreak deployer.</p>
</li>
<li>
<p>Initialize your profile by creating a new file called <code>Profile</code> and adding the following content:</p>
<p><pre>export UAA_DEFAULT_SECRET=MY-SECRET
export UAA_DEFAULT_USER_PW=MY-PASSWORD
export UAA_DEFAULT_USER_EMAIL=MY-EMAIL</pre>  </p>
<p>For example: </p>
<p><pre>export UAA_DEFAULT_SECRET=MySecret123
export UAA_DEFAULT_USER_PW=MySecurePassword123
export UAA_DEFAULT_USER_EMAIL=dbialek@hortonworks.com</pre> </p>
<blockquote>
<p>You will need to provide the email and password when logging in to the Cloudbreak web UI and when using the Cloudbreak CLI. The secret will be used by Cloudbreak for authentication.  </p>
</blockquote>
</li>
<li>
<p>Start the Cloudbreak application by using the following command:</p>
<p><pre>cbd start</pre></p>
<p>This will start the Docker containers and initialize the application. The first time you start the Coudbreak app, the process will take longer than usual due to the download of all the necessary docker images.</p>
<p>The <code>cbd start</code> command includes the <code>cbd generate</code> command which applies the following steps:</p>
<ul>
<li>Creates the <code>docker-compose.yml</code> file, which describes the configuration of all the Docker containers needed for the Cloudbreak deployment.</li>
<li>Creates the <code>uaa.yml</code> file, which holds the configuration of the identity server used to authenticate users with Cloudbreak.</li>
</ul>
<blockquote>
<p>Once the <code>cbd start</code> has finished, it returns the "Uluwatu (Cloudbreak UI) url" which you can later paste in your browser and log in to Cloudbreak web UI. </p>
</blockquote>
</li>
<li>
<p>Check Cloudbreak deployer version and health: </p>
<p><pre>cbd doctor</pre></p>
</li>
<li>
<p>Next, check Cloudbreak Application logs: </p>
<p><pre>cbd logs cloudbreak</pre></p>
<p>You should see a message like this in the log: <code>Started CloudbreakApplication in 36.823 seconds.</code> Cloudbreak normally takes less than a minute to start.</p>
</li>
</ol>
<h3 id="access-cloudbreak-ui">Access Cloudbreak UI</h3>
<p>Log in to the Cloudbreak UI using the following steps.</p>
<p><strong>Steps</strong></p>
<ol>
<li>
<p>You can log into the Cloudbreak application at <code>https://IPv4_Public_IP&gt;/</code> or <code>https://Public_DNS</code>. For example <code>https://34.212.141.253</code> or <code>https://ec2-34-212-141-253.us-west-2.compute.amazonaws.com</code>. </p>
</li>
<li>
<p>Confirm the security exception to proceed to the Cloudbreak web UI.</p>
<p>The first time you access Cloudbreak UI, Cloudbreak will automatically generate a self-signed certificate, due to which your browser will warn you about an untrusted connection and will ask you to confirm a security exception.</p>
</li>
<li>
<p>The login page is displayed:</p>
<p><a href="../images/cb-ui.png" target="_blank" title="click to enlarge"><img src="../images/cb-ui.png" width="650" title="Cloudbreak web UI"></a>  </p>
</li>
<li>
<p>Log in to the Cloudbreak web UI using the credential that you configured in your <code>Profile</code> file when <a href="#launch-cloudbreak-deployer">launching Cloudbreak deployer</a>:</p>
<ul>
<li>The username is the <code>UAA_DEFAULT_USER_EMAIL</code>     </li>
<li>The password is the <code>UAA_DEFAULT_USER_PW</code> </li>
</ul>
</li>
<li>
<p>Upon a successful login, you are redirected to the dashboard:</p>
<p><a href="../images/cb-ui1.png" target="_blank" title="click to enlarge"><img src="../images/cb-ui1.png" width="650" title="Cloudbreak web UI"></a>  </p>
</li>
</ol>
<h3 id="create-cloudbreak-credential">Create Cloudbreak Credential</h3>
<p>Before you can start creating clusters, you must first create a <a href="../architecture/index.html#cloudbreak-credential">Cloudbreak credential</a>. Without this credential, you will not be able to create clusters via Cloudbreak. </p>
<p>As part of the <a href="../(#authentication)">prerequisites</a>, you had two options to allow Cloudbreak to authenticate with AWS and create resources on your behalf: key-based or role-based authentication. </p>
<p>Depending on your choice, you must configure a key-based or role-based credential: </p>
<p><a href="#create-key-based-credential">Create Key-Based Credential</a><br />
<a href="#create-role-based-credential">Create Role-Based Credential</a></p>
<h4 id="create-key-based-credential">Create Key-Based Credential</h4>
<p>To perform these steps, you must know your access and secret key. If needed, you or your AWS administrator can generate new access and secret keys from the <strong>IAM Console</strong> &gt; <strong>Users</strong> &gt; select a user &gt; <strong>Security credentials</strong>. </p>
<p><strong>Steps</strong></p>
<ol>
<li>
<p>In the Cloudbreak web UI, select <strong>Credentials</strong> from the navigation pane. </p>
</li>
<li>
<p>Click <strong>Create Credential</strong>. </p>
</li>
<li>
<p>Under <strong>Cloud provider</strong>, select "Amazon Web Services":</p>
<p><a href="../images/cb-aws-cred-key.png" target="_blank" title="click to enlarge"><img src="../images/cb-aws-cred-key.png" width="650" title="Cloudbreak web UI"></a>  </p>
</li>
<li>
<p>Provide the following information:</p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Select Credential Type</td>
<td>Select <strong>Key Based</strong>.</td>
</tr>
<tr>
<td>Name</td>
<td>Enter a name for your credential.</td>
</tr>
<tr>
<td>Description</td>
<td>(Optional) Enter a description.</td>
</tr>
<tr>
<td>Access Key</td>
<td>Paste your access key.</td>
</tr>
<tr>
<td>Secret Access Key</td>
<td>Paste your secret key.</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>Click <strong>Create</strong>.</p>
</li>
<li>
<p>Your credential should now be displayed in the <strong>Credentials</strong> pane.</p>
<p>Congratulations! You've successfully launched Cloudbreak and create a Cloudbreak credential. Now it's time to <a href="../aws-create/index.html">create a cluster</a>. </p>
</li>
</ol>
<h4 id="create-role-based-credential">Create Role-Based Credential</h4>
<p>To perform these steps, you must know the <strong>IAM Role ARN</strong> corresponding to the "CredentialRole" (configured as a <a href="#authorization-for-cloudbreak">prerequisite</a>).  </p>
<p><strong>Steps</strong></p>
<ol>
<li>
<p>In the Cloudbreak web UI, select <strong>Credentials</strong> from the navigation pane. </p>
</li>
<li>
<p>Click <strong>Create Credential</strong>. </p>
</li>
<li>
<p>Under <strong>Cloud provider</strong>, select "Amazon Web Services":</p>
<p><a href="../images/cb-aws-cred-role.png" target="_blank" title="click to enlarge"><img src="../images/cb-aws-cred-role.png" width="650" title="Cloudbreak web UI"></a>  </p>
</li>
<li>
<p>Provide the following information:</p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Select Credential Type</td>
<td>Select <strong>Role Based</strong> (default value).</td>
</tr>
<tr>
<td>Name</td>
<td>Enter a name for your credential.</td>
</tr>
<tr>
<td>Description</td>
<td>(Optional) Enter a description.</td>
</tr>
<tr>
<td>IAM Role ARN</td>
<td>Paste the IAM Role ARN corresponding to the "CredentialRole" that you created earlier. For example <code>arn:aws:iam::315627065446:role/CredentialRole</code> is a valid IAM Role ARN.</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>Click <strong>Create</strong>.</p>
</li>
<li>
<p>Your credential should now be displayed in the <strong>Credentials</strong> pane.</p>
<p>Congratulations! You have successfully launched Cloudbreak and created a Cloudbreak credential. Now you can use Cloubdreak to <a href="../aws-create/index.html">create clusters</a>. </p>
</li>
</ol>
<div class="next">
<a href="../aws-create/index.html">Next: Create a Cluster</a>
</div></div>
        
    </div>

    <footer class="col-md-12 text-center">
        <hr>
        <p>
        <small>© 2011-2017 <a href="http://www.hortonworks.com" target="_blank">Hortonworks Inc</a>. All Rights Reserved. | <a href="http://hortonworks.com/privacy-policy/" target="_blank">Privacy Policy</a><br></small>
        
        <small>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</p></small>
    </footer>

    <script src="../js/jquery-1.10.2.min.js"></script>
    <script src="../js/bootstrap-3.0.3.min.js"></script>
    <script src="../js/highlight.pack.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script>
    var base_url = '..';
    </script>
    <script data-main="../mkdocs/js/search.js" src="../mkdocs/js/require.js"></script>
    <script src="../js/base.js"></script>

    <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">
                        <span aria-hidden="true">&times;</span>
                        <span class="sr-only">Close</span>
                    </button>
                    <h4 class="modal-title" id="exampleModalLabel">Search</h4>
                </div>
                <div class="modal-body">
                    <p>
                        From here you can search these documents. Enter your search terms below.
                    </p>
                    <form role="form">
                        <div class="form-group">
                            <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query">
                        </div>
                    </form>
                    <div id="mkdocs-search-results"></div>
                </div>
                <div class="modal-footer">
                </div>
            </div>
        </div>
    </div>

    </body>

</html>
