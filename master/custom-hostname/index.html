<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">  
    <link rel="canonical" href="http://hortonworks.github.io/cloudbreak-documentation/custom-hostname/index.html"> 
    <link rel="shortcut icon" href="../images/favicon.png">

    <title>Use custom hostnames based on DNS - Cloudbreak</title>

    <link href="../css/bootstrap-custom.min.css" rel="stylesheet">
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css" rel="stylesheet">
    <link rel="stylesheet" href="//cdn.jsdelivr.net/font-hack/2.018/css/hack.min.css">
    <link href='//fonts.googleapis.com/css?family=PT+Sans:400,400italic,700,700italic&subset=latin-ext,latin' rel='stylesheet' type='text/css'>
    <link href='//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,700italic,400,300,600,700&subset=latin-ext,latin' rel='stylesheet' type='text/css'>
    <link href="../css/base.css" rel="stylesheet">
    <link href="../css/cinder.css" rel="stylesheet">
    <link rel="stylesheet" href="../css/highlight.css">


    <link href="../css/extra.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

    <script src="https://ajax.googleapis.com/ajax/libs/webfont/1.5.18/webfont.js"></script>
    <script>
    WebFont.load({
        google: {
            families: ['Open Sans', 'PT Sans']
        }
    });
    </script>

    
    <script>
    (function(i, s, o, g, r, a, m) {
        i['GoogleAnalyticsObject'] = r;
        i[r] = i[r] || function() {
            (i[r].q = i[r].q || []).push(arguments)
        }, i[r].l = 1 * new Date();
        a = s.createElement(o),
        m = s.getElementsByTagName(o)[0];
        a.async = 1;
        a.src = g;
        m.parentNode.insertBefore(a, m)
    })(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');

    ga('create', 'UA-22950817-24', 'auto');
    ga('send', 'pageview');
    </script>
    
</head>

<body>

    <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            

            <!-- Main title -->
            <a class="navbar-brand" href="../index.html">Cloudbreak</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
            
                <!-- Main navigation -->
                <ul class="nav navbar-nav">
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Intro <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../index.html">Introduction</a>
</li>

                        
                            
<li >
    <a href="../architecture/index.html">Architecture</a>
</li>

                        
                            
<li >
    <a href="../concepts/index.html">Core concepts</a>
</li>

                        
                            
<li >
    <a href="../deployment-options/index.html">Deployment options</a>
</li>

                        
                            
<li >
    <a href="../security/index.html">Security overview</a>
</li>

                        
                        </ul>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">AWS <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../aws-pre/index.html">Prerequisites</a>
</li>

                        
                            
<li >
    <a href="../aws-launch/index.html">Launch on AWS</a>
</li>

                        
                            
<li >
    <a href="../aws-create/index.html">Create a cluster</a>
</li>

                        
                            
<li >
    <a href="../aws-clusters-access/index.html">Access cluster</a>
</li>

                        
                            
<li >
    <a href="../aws-clusters-manage/index.html">Manage and monitor clusters</a>
</li>

                        
                            
<li >
    <a href="../aws-data/index.html">Access data on S3</a>
</li>

                        
                        </ul>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Azure <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../azure-pre/index.html">Prerequisites</a>
</li>

                        
                            
<li >
    <a href="../azure-launch/index.html">Launch on Azure</a>
</li>

                        
                            
<li >
    <a href="../azure-create/index.html">Create a cluster</a>
</li>

                        
                            
<li >
    <a href="../azure-clusters-access/index.html">Access cluster</a>
</li>

                        
                            
<li >
    <a href="../azure-clusters-manage/index.html">Manage and monitor clusters</a>
</li>

                        
                            
<li >
    <a href="../azure-data/index.html">Access data on Azure</a>
</li>

                        
                        </ul>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">GCP <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../gcp-pre/index.html">Prerequisites</a>
</li>

                        
                            
<li >
    <a href="../gcp-launch/index.html">Launch on GCP</a>
</li>

                        
                            
<li >
    <a href="../gcp-create/index.html">Create a cluster</a>
</li>

                        
                            
<li >
    <a href="../gcp-clusters-access/index.html">Access cluster</a>
</li>

                        
                            
<li >
    <a href="../gcp-clusters-manage/index.html">Manage and monitor clusters</a>
</li>

                        
                        </ul>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">OpenStack <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../os-pre/index.html">Prerequisites</a>
</li>

                        
                            
<li >
    <a href="../os-launch/index.html">Launch on OpenStack</a>
</li>

                        
                            
<li >
    <a href="../os-create/index.html">Create a cluster</a>
</li>

                        
                            
<li >
    <a href="../os-clusters-access/index.html">Access cluster</a>
</li>

                        
                            
<li >
    <a href="../os-clusters-manage/index.html">Manage and monitor clusters</a>
</li>

                        
                        </ul>
                    </li>
                
                
                
                    <li class="dropdown active">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Using Cloudbreak <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../vm-launch/index.html">Launch Cloudbreak (production)</a>
</li>

                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="">Advanced cluster options</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../blueprints/index.html">Use custom blueprints</a>
</li>

        
            
<li >
    <a href="../recipes/index.html">Use custom scripts (recipes)</a>
</li>

        
            
<li >
    <a href="../mpacks/index.html">Use management packs</a>
</li>

        
            
<li >
    <a href="../images/index.html">Use custom images</a>
</li>

        
            
<li >
    <a href="../tags/index.html">Tag resources</a>
</li>

        
            
<li >
    <a href="../security-kerberos/index.html">Enable Kerberos security</a>
</li>

        
            
<li >
    <a href="../autoscaling/index.html">Configure autoscaling</a>
</li>

        
            
<li >
    <a href="../external-db/index.html">Register external database</a>
</li>

        
            
<li >
    <a href="../external-ldap/index.html">Register external authentication source</a>
</li>

        
            
<li >
    <a href="../external-proxy/index.html">Register proxy configuration</a>
</li>

        
            
<li class="active">
    <a href="index.html">Use custom hostnames based on DNS</a>
</li>

        
    </ul>
  </li>

                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="">Advanced Cloudbreak options</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../cb-credentials/index.html">Manage Cloudbreak credentials</a>
</li>

        
            
<li >
    <a href="../cb-migrate/index.html">Move Cloudbreak instance</a>
</li>

        
            
<li >
    <a href="../cb-ldap/index.html">Configure LDAP/AD authentication for Cloudbreak</a>
</li>

        
            
<li >
    <a href="../security-cb-ssl/index.html">Add SSL certificate for Cloudbreak UI</a>
</li>

        
            
<li >
    <a href="../cb-proxy/index.html">Configure outbound internet access and proxy</a>
</li>

        
            
<li >
    <a href="../security-cb-inbound/index.html">Restrict inbound access to clusters</a>
</li>

        
            
<li >
    <a href="../security-cb-customdom/index.html">Configure access from custom domains</a>
</li>

        
            
<li >
    <a href="../cb-db/index.html">Configure external Cloudbreak database</a>
</li>

        
            
<li >
    <a href="../cb-disable-provider/index.html">Disable providers</a>
</li>

        
            
<li >
    <a href="../cb-ports/index.html">Change default Cloudbreak ports</a>
</li>

        
            
<li >
    <a href="../cb-profile/index.html">Modify settings in Cloudbreak Profile</a>
</li>

        
    </ul>
  </li>

                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="">Cloudbreak CLI</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../cli-install/index.html">Install the CLI</a>
</li>

        
            
<li >
    <a href="../cli-get-started/index.html">Get started with the CLI</a>
</li>

        
            
<li >
    <a href="../cli-reference/index.html">CLI Reference</a>
</li>

        
    </ul>
  </li>

                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="">Troubleshooting</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../trouble-cb-logs/index.html">Cloudbreak logs</a>
</li>

        
            
<li >
    <a href="../trouble-cb/index.html">Troubleshooting Cloudbreak</a>
</li>

        
            
<li >
    <a href="../trouble-cluster/index.html">Troubleshooting cluster creation</a>
</li>

        
            
<li >
    <a href="../trouble-aws/index.html">Troubleshooting AWS</a>
</li>

        
            
<li >
    <a href="../trouble-azure/index.html">Troubleshooting Azure</a>
</li>

        
            
<li >
    <a href="../trouble-gcp/index.html">Troubleshooting GCP</a>
</li>

        
            
<li >
    <a href="../trouble-cli/index.html">Troubleshooting Cloudbreak CLI</a>
</li>

        
    </ul>
  </li>

                        
                            
<li >
    <a href="../cb-upgrade/index.html">Upgrade Cloudbreak</a>
</li>

                        
                            
<li >
    <a href="../cb-delete/index.html">Delete Cloudbreak</a>
</li>

                        
                        </ul>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">More <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../releasenotes/index.html">Release Notes</a>
</li>

                        
                            
<li >
    <a href="../faq/index.html">FAQs</a>
</li>

                        
                            
<li >
    <a href="../dev/index.html">Developer documentation links</a>
</li>

                        
                            
<li >
    <a href="../get-help/index.html">Getting help</a>
</li>

                        
                            
<li >
    <a href="../smartsense/index.html">SmartSense telemetry</a>
</li>

                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="">Legal</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../acknowledge/index.html">Acknowledgements</a>
</li>

        
    </ul>
  </li>

                        
                        </ul>
                    </li>
                
                
                </ul>
            

            <ul class="nav navbar-nav navbar-right">
                
                    <li >
                        <a rel="next" href="../external-proxy/index.html">
                            <i class="fa fa-arrow-left"></i> Previous
                        </a>
                    </li>
                    <li >
                        <a rel="prev" href="../cb-credentials/index.html">
                            Next <i class="fa fa-arrow-right"></i>
                        </a>
                    </li>
                
                
                    <li>
                        <a href="https://github.com/hortonworks/cloudbreak-documentation">
                            
                                <i class="fa fa-github"></i>
                            
                            GitHub
                        </a>
                    </li>
                
            </ul>
        </div>
    </div>
</div>

    <div class="container">
        
        <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
    
        <li class="first-level active"><a href="#configuring-custom-hostnames-based-on-domain-name-system-dns">Configuring Custom hostnames based on Domain Name System (DNS)</a></li>
        
            <li class="second-level"><a href="#configure-reverse-dns-on-aws">Configure reverse DNS on AWS</a></li>
            
                <li class="third-level"><a href="#using-route53">Using Route53</a></li>
            
                <li class="third-level"><a href="#using-custom-dns-server">Using custom DNS server</a></li>
            
        
    
    </ul>
</div></div>
        <div class="col-md-9" role="main">

<h2 id="configuring-custom-hostnames-based-on-domain-name-system-dns">Configuring Custom hostnames based on Domain Name System (DNS)</h2>
<p>It's is possible to have different hostnames for cluster members other than the ones configured by the service provider by default.
When the cluster member machines are spun up they try to make a reverse DNS lookup (by querying of the DNS to determine the domain name associated with a specific IP address) and if it returns a valid value, then it is set as hostname.</p>
<h3 id="configure-reverse-dns-on-aws">Configure reverse DNS on AWS</h3>
<p>On AWS you have the following two options:</p>
<ul>
<li>use <a href="https://aws.amazon.com/route53/">Route53</a> as DNS provider</li>
<li>setup your own DNS server in your VPC</li>
</ul>
<p>Both setups require the customer to have a VPC and attach a custom <a href="https://docs.aws.amazon.com/AmazonVPC/latest/UserGuide/VPC_DHCP_Options.html">DHCP option</a> to it.</p>
<h4 id="using-route53">Using Route53</h4>
<ol>
<li><strong>Create or bring your own VPC</strong><ol>
<li>CIDR eg. <em>10.1.0.0/16</em></li>
<li>Enable DNS resolution and <strong>DNS hostnames</strong></li>
<li>Create a subnet with CIDR eg. <em>10.1.1.0/28</em><blockquote>
<p>Notice that you might want to set an Internet Gateway for the VPC and add a default route to the routing table for the IGW.
Also you may enable <em>Auto-assign Public IP</em> option.
This way Cloudbreak would reach the cluster from outside of the VPC and the cluster would have internet access.</p>
</blockquote>
</li>
</ol>
</li>
<li>
<p><strong>Setup DHCP options</strong></p>
<ol>
<li>Create a DHCP Option Set as documented <a href="https://docs.aws.amazon.com/directoryservice/latest/admin-guide/dhcp_options_set.html">here</a>.</li>
<li>Set the domain name to a preferred domain, eg. cloudbreak.beer</li>
<li>
<p>Set domain name servers to AmazonProviderDNS</p>
<p><a href="../images/aws-route53-dhcp-option.png" target="_blank" title="click to enlarge"><img src="../images/aws-route53-dhcp-option.png" width="350" title="DHCP option for Route53"></a> <br />
    4. Go back to your VPC view and click on <em>Actions -&gt; Edit DHCP Options Set</em> to be able select the newly created DHCP Option Set for the VPC</p>
</li>
</ol>
</li>
<li>
<p><strong>Configure domain at Route53</strong></p>
<ol>
<li>Go to the Route53 service page in AWS console</li>
<li>Create a Hosted Zone as documented <a href="https://docs.aws.amazon.com/Route53/latest/DeveloperGuide/hosted-zone-private-creating.html">here</a><ul>
<li>with the Domain Name used previously with DHCP Options</li>
<li>set the Type to <em>Private Hosted Zone for Amazon VPC</em></li>
<li>select the VPC ID to which you previously assigned the DHCP option</li>
</ul>
</li>
<li>
<p>Add records</p>
<ul>
<li>Go to <em>Record set</em></li>
<li>Use <em>Create Record Set</em> for every available IP to have a custom name (10.1.1.4-14 if you have the subnet used above)<ul>
<li>Type: A</li>
<li>Name: eg. <em>b10</em></li>
<li>
<p>Value: eg. <em>10.1.1.10</em></p>
<p><a href="../images/aws-route53-record.png" target="_blank" title="click to enlarge"><img src="../images/aws-route53-record.png" width="350" title="Domain record for Route53"></a></p>
</li>
</ul>
</li>
</ul>
</li>
<li>
<p>Create another hosted zone for reverse DNS lookup.</p>
<ul>
<li>
<p>It's domain name should look like this if you used the previous subnet (as reverse DNS lookups use the special domain <em>in-addr.arpa</em>):</p>
<p><pre>1.1.10.in-addr.arpa.</pre></p>
</li>
<li>
<p>set the Type to <em>Private Hosted Zone for Amazon VPC</em></p>
</li>
<li>select the VPC ID to which you previously assigned the DHCP option</li>
</ul>
</li>
<li>
<p>Add records (for every created domain)</p>
<ul>
<li>Type: PTR</li>
<li>Name: is the IP last part eg. <em>10</em></li>
<li>
<p>Value: the domain name you set in the previous step eg. <em>b10</em></p>
<p><a href="../images/aws-route53-reverse-record.png" target="_blank" title="click to enlarge"><img src="../images/aws-route53-reverse-record.png" width="350" title="Domain PTR record for Route53"></a></p>
</li>
</ul>
</li>
</ol>
</li>
<li>
<p><strong>Create the cluster</strong> in the VPC and you will have the same hostnames set as the domain names.</p>
<blockquote>
<p>Notice that you don't have control the order over the IP addresses leased to the machines, so the names may not be in order.</p>
</blockquote>
</li>
</ol>
<h4 id="using-custom-dns-server">Using custom DNS server</h4>
<ol>
<li><strong>Create or bring your own VPC</strong><ol>
<li>CIDR eg. <em>10.3.0.0/16</em></li>
<li>Enable DNS resolution and <strong>DNS hostnames</strong></li>
<li>Create a subnet with CIDR eg. <em>10.3.3.0/28</em><blockquote>
<p>Notice that you might want to set an Internet Gateway for the VPC and add a default route to the routing table for the IGW.
Also you may enable <em>Auto-assign Public IP</em> option.
This way Cloudbreak would reach the cluster from outside of the VPC and the cluster would have internet access.</p>
</blockquote>
</li>
</ol>
</li>
<li>
<p><strong>Setup DNS server</strong> in your VPC/subnet</p>
<ol>
<li>In the configuration ensure that you have DNS records and reverse DNS pointers for all IP address (eg. 10.3.3.4-14)</li>
<li>
<p>Example unbound configuration:</p>
<p><pre>
    [root@ip-10-3-3-9 conf.d]# cat 00-cloudbreak.cloud.conf
    server:
        local-zone: "cloudbreak.cloud." static
        local-data: "aww1.cloudbreak.cloud. IN A 10.3.3.4"
        local-data-ptr: "10.3.3.4 aww1.cloudbreak.cloud."
        local-data: "aww2.cloudbreak.cloud. IN A 10.3.3.5"
        local-data-ptr: "10.3.3.5 aww2.cloudbreak.cloud."
        local-data: "aww3.cloudbreak.cloud. IN A 10.3.3.6"
        local-data-ptr: "10.3.3.6 aww3.cloudbreak.cloud."
        local-data: "aww4.cloudbreak.cloud. IN A 10.3.3.7"
        local-data-ptr: "10.3.3.7 aww4.cloudbreak.cloud."
        local-data: "aww5.cloudbreak.cloud. IN A 10.3.3.8"
        local-data-ptr: "10.3.3.8 aww5.cloudbreak.cloud."
        local-data: "aww6.cloudbreak.cloud. IN A 10.3.3.9"
        local-data-ptr: "10.3.3.9 aww6.cloudbreak.cloud."
        local-data: "aww7.cloudbreak.cloud. IN A 10.3.3.10"
        local-data-ptr: "10.3.3.10 aww7.cloudbreak.cloud."
        local-data: "aww8.cloudbreak.cloud. IN A 10.3.3.11"
        local-data-ptr: "10.3.3.11 aww8.cloudbreak.cloud."
        local-data: "aww9.cloudbreak.cloud. IN A 10.3.3.12"
        local-data-ptr: "10.3.3.12 aww9.cloudbreak.cloud."
        local-data: "aww10.cloudbreak.cloud. IN A 10.3.3.13"
        local-data-ptr: "10.3.3.13 aww10.cloudbreak.cloud."
        local-data: "aww11.cloudbreak.cloud. IN A 10.3.3.14"
        local-data-ptr: "10.3.3.14 aww11.cloudbreak.cloud."
</pre></p>
</li>
</ol>
</li>
<li>
<p><strong>Setup DHCP options</strong></p>
<ol>
<li>Set the domain name to a preferred domain, eg. cloudbreak.cloud</li>
<li>
<p>Set domain name servers to the previously created DNS server</p>
<p><a href="../images/aws-custondns-dhcp-option.png" target="_blank" title="click to enlarge"><img src="../images/aws-custondns-dhcp-option.png" width="350" title="DHCP option for own DNS server"></a> <br />
    3. Go back to your VPC view and click on <em>Actions -&gt; Edit DHCP Options Set</em> to be able select the newly created DHCP Option Set for the VPC</p>
</li>
</ol>
</li>
<li>
<p><strong>Create the cluster</strong> in the VPC and you will have the same hostnames set as the domain names.</p>
<blockquote>
<p>Notice that you don't have control the order over the IP address leased to the machines, so the names may not be in order.</p>
</blockquote>
</li>
</ol></div>
        
    </div>

    <footer class="col-md-12 text-center">
        <hr>
        <p>
        <small>Â© 2011-2018 <a href="http://www.hortonworks.com" target="_blank">Hortonworks Inc</a>. All Rights Reserved. | <a href="http://hortonworks.com/privacy-policy/" target="_blank">Privacy Policy</a><br></small>
        
        <small>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</p></small>
    </footer>

    <script src="../js/jquery-1.10.2.min.js"></script>
    <script src="../js/bootstrap-3.0.3.min.js"></script>
    <script src="../js/highlight.pack.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script>
    var base_url = '..';
    </script>
    <script data-main="../mkdocs/js/search.js" src="../mkdocs/js/require.js"></script>
    <script src="../js/base.js"></script>

    <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">
                        <span aria-hidden="true">&times;</span>
                        <span class="sr-only">Close</span>
                    </button>
                    <h4 class="modal-title" id="exampleModalLabel">Search</h4>
                </div>
                <div class="modal-body">
                    <p>
                        From here you can search these documents. Enter your search terms below.
                    </p>
                    <form role="form">
                        <div class="form-group">
                            <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query">
                        </div>
                    </form>
                    <div id="mkdocs-search-results"></div>
                </div>
                <div class="modal-footer">
                </div>
            </div>
        </div>
    </div>

    </body>

</html>
